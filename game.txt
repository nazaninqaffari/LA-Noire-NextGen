# LA Noire NextGen - Game Mechanics & Workflow Reference
# =====================================================
# English translation of all game-related mechanisms from doc.txt
# This document serves as the comprehensive reference for all workflows,
# roles, crime levels, and game mechanics in the system.

## 1. Overview

The game is inspired by Rockstar's L.A. Noire. The player assumes the role of
a detective in the Los Angeles Police Department, solving criminal cases.
The original game is set in the late 1940s where all police operations were
done manually on paper. Now in 2025, the police department has decided to
automate its operations and store data digitally. This system is the web
application that fulfills those requirements.

## 2. User Roles

All base user roles in the system:

| Role               | Key              | Description |
|--------------------|------------------|-------------|
| System Admin       | Administrator    | Full access, manages roles and users |
| Police Chief       | Police Chief     | Highest police rank, handles critical cases |
| Captain            | Captain          | Approves interrogation results, sends to court |
| Sergeant           | Sergeant         | Oversees detective work, issues arrest warrants, conducts interrogations |
| Detective          | Detective        | Investigates cases, identifies suspects, uses detective board |
| Police Officer     | Police Officer   | Field operations, reports crime scenes |
| Patrol Officer     | Patrol Officer   | Field operations, reports crime scenes |
| Cadet              | Cadet            | Lowest police rank, initial screening of complaints |
| Complainant/Client | (Normal User)    | Files complaints, submits case information |
| Witness            | Witness          | Provides testimony for cases |
| Suspect/Accused    | Suspect          | Person identified as suspect in a case |
| Criminal           | Criminal         | Convicted person |
| Judge              | Judge            | Delivers verdict and sentencing |
| Forensic Doctor    | Coroner          | Reviews and verifies biological/medical evidence |
| Normal User        | Base User        | Default role after registration |

**Important:** The system admin must be able to add, remove, or modify roles
without changing any code.

## 3. Crime Levels

| Level    | Value | Examples                                |
|----------|-------|-----------------------------------------|
| Level 3  | 3     | Minor crimes (petty theft, minor fraud)  |
| Level 2  | 2     | Medium crimes (car theft)                |
| Level 1  | 1     | Major crimes (murder)                    |
| Critical | 0     | Mass crimes (serial murder, terrorism)   |

## 4. Workflows / Flows

### 4.1 Registration & Login

- Each user registers with: username, password, email, phone number,
  first name, last name, and national ID
- Default role after registration: Normal User (Base User)
- System admin assigns additional roles as needed
- Login accepts password + one of: username, national ID, phone, email
- All identifiers must be unique

### 4.2 Case Formation

A case begins when either:
1. A complainant files a complaint, OR
2. A police officer (non-cadet) witnesses/receives report of a crime scene

#### 4.2.1 Case Formation via Complaint

**Flow: Client → Cadet → Officer**

1. Complainant logs in and submits case information
2. Case goes to a Cadet for initial review
3. **If Cadet approves:** Case moves to Police Officer review
4. **If Cadet rejects:** Case returns to complainant (draft status) with
   an error message written by the cadet. Complainant can edit and resubmit.
   - **Same cadet** should review the resubmitted case
   - **After 3 rejections:** Case is permanently dismissed/rejected
5. **If Officer approves:** Case is now OPEN for investigation
6. **If Officer rejects:** Case goes back to Cadet (NOT directly to complainant).
   The cadet re-reviews and can then either approve or reject back to complainant.
   - Officer rejection does NOT increment the rejection counter

**Key rules:**
- A case may have multiple complainants (added by cadet)
- Complainant information is verified/rejected by cadet
- On cadet rejection, the complainant gets the rejection reason and can edit all fields
- On resubmission, the case goes back to cadet_review status

#### 4.2.2 Case Formation via Crime Scene Report

1. A police officer (non-cadet) witnesses or receives a crime report
2. Officer records: crime scene location, date/time, witness info
3. Case needs approval from one superior rank
4. If Police Chief creates it, no approval needed (auto-opens)
5. Initially no complainants, but they can be added later

### 4.3 Evidence Registration

Evidence is divided into categories, all with title, description, date, and registerer:

1. **Witness Testimony (Transcription):** Statements from witnesses.
   Can include images, video, or audio related to the incident.

2. **Biological/Medical Evidence:** Blood stains, hair strands, fingerprints.
   Must be verified by forensic doctor or identity database.
   Stored with title, description, images. Follow-up results initially empty.

3. **Vehicle Evidence:** Vehicles found at the crime scene.
   Must record model, plate number, color. If no plate, serial number required.
   Plate and serial number cannot both have values simultaneously.

4. **Identity Documents:** ID cards or documents found at the scene.
   Stored as key-value pairs (flexible, can be empty).

5. **Other Evidence:** Generic title-description records.

### 4.4 Case Resolution (Detective Board)

After a case is opened, a Detective can investigate it using a **Detective Board**:
- The board contains evidence items, notes, and leads
- Items are placed at arbitrary positions (drag-and-drop)
- Related items can be connected with **red lines**
- The board supports image export
- **Evidence from the case should be visible on the board**
- New evidence can be added during investigation (triggers notification to detective)

### 4.5 Suspect Identification & Sergeant Approval

After investigating, the Detective identifies the main suspects:

1. **Detective creates a suspect list** with reasoning
2. **Suspect list is sent to Sergeant** for approval
3. **Sergeant reviews** evidence and matches detective's reasoning with suspect records
4. **If Sergeant approves:** Confirmation sent to detective, arrest of suspects begins.
   Case status → arrest_approved
5. **If Sergeant disagrees:** Objection message sent back to detective.
   Case remains open (under_investigation). Detective can revise and resubmit.

**Notifications:**
- When detective submits suspects → Sergeant gets notified
- When sergeant approves/rejects → Detective gets notified
- When new evidence is added to a case → Detective gets notified

### 4.6 Interrogation

After arrest:
1. Suspects are interrogated by Sergeant and Detective together
2. Both rate guilt probability from 1 (least) to 10 (most)
3. Ratings go to Captain for final decision with evidence
4. For Critical-level crimes: Police Chief must also approve Captain's decision

### 4.7 Trial

1. Guilty person goes to court
2. Judge sees the full case: evidence, all involved police with details,
   reports, approvals/rejections
3. Judge delivers verdict (guilty/not guilty) with sentencing details

### 4.8 Suspect Status / Most Wanted

- When identified as suspect → status: "under pursuit"
- If under pursuit > 1 month → status: "intensive pursuit" (Most Wanted page)
- **Most Wanted ranking formula:** max(days_pursued) × max(crime_level_value)
  where crime_level_value = 1..4 (Level 3 → 1, Critical → 4)
- **Reward formula:** max(days_pursued) × max(crime_level_value) × 20,000,000 Rials
- Most Wanted page shows photo, details, reward for all intensive-pursuit suspects

### 4.9 Rewards (Tip-offs)

1. Normal user provides information about a case or suspect
2. Police officer does initial review
3. If valid, information goes to case detective
4. If detective confirms info is useful: user gets a unique reward code
5. User goes to police station with the code to claim reward
6. All police ranks can verify reward: enter national ID + code → see reward amount + user info

### 4.10 Bail and Fine Payment (Optional)

- Suspects of Level 2 and 3 crimes can post bail
- Criminals of Level 3 (if sergeant approves) can pay fines
- Amount determined by sergeant
- System must connect to a payment gateway

## 5. Required Pages

| Page                    | Description |
|-------------------------|-------------|
| Home Page               | System introduction, police dept info, at least 3 stats |
| Login & Register        | Dedicated auth pages |
| Modular Dashboard       | Role-based dashboard modules |
| Detective Board         | Visual investigation board with drag-drop, red lines, export |
| Most Wanted             | Intensive-pursuit suspects with details and rewards |
| Case & Complaint Status | View/edit cases based on access level |
| General Reports         | For judges, captains, police chief - full case reports |
| Evidence Review         | Register and review evidence per access level |

## 6. Notification System

The system must support notifications for:
- New evidence added to a case under investigation → notify detective
- Detective submits suspect list → notify sergeant(s)
- Sergeant approves suspect submission → notify detective
- Sergeant rejects suspect submission → notify detective
- Case status changes → notify relevant parties
- Tip-off submissions → notify relevant officers
- Reward availability → notify tip-off submitter

Notifications should be accessible via a bell icon in the header,
showing unread count and a dropdown of recent notifications.
